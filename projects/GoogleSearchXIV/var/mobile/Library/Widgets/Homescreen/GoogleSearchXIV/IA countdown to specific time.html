<html>

<head>
    <title>IA Specific Countdown Timer</title>
</head>

<body>
    <p id="pmDebugTime"></p>
    <script>
        window.onload = function() {
          setPmTime();
        }

        var pmHour =7;
        var pmMinute = 27;

        if (pmHour < 12) {
            pmHour = pmHour + 12;
        }

        function setPmTime() {
          var day = (1000 * 60 * 60 * 24);
          var userSetPmTime = (pmHour * 60) + pmMinute;
          var getCurrentTime = new Date();
          var getCurrentMinutes = getCurrentTime.getMinutes();
          var getCurrentHours = getCurrentTime.getHours();
          var pmResetCount = getCurrentTime.setMinutes(getCurrentTime.getMinutes() - (getCurrentHours * 60) - getCurrentMinutes + userSetPmTime);
          var pmFutureCount = pmResetCount + day;
          var resetTimer;

          var timer = setInterval(function() {
            var now = new Date();

              if (now > pmResetCount) {
                setTimeout(function(){
                  resetTimer = new Date(pmFutureCount);
                }, 1000);
              } else if (now < pmResetCount){
              resetTimer = new Date(pmResetCount);
              }
              console.log(resetTimer);
              var timeRemaining = resetTimer - now;
              //DEBUG
              var hours = Math.floor((timeRemaining % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
              var minutes = Math.floor((timeRemaining % (1000 * 60 * 60)) / (1000 * 60));

              var pmDebugTime = document.getElementById("pmDebugTime").innerHTML = (hours + "h " + minutes + "m");
              //(hours + "h " + minutes + "m");

              if (timeRemaining < 0) {
                clearInterval(timer);
                document.body.style.backgroundColor = "green";
                setTimeout(function(){
                  window.location.reload(true);
                }, 1000);
              }
          }, 1000);
      }

    </script>
</body>

</html>